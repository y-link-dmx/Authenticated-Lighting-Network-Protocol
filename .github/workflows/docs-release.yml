name: Docs Release

on:
  release:
    types: [published]

permissions:
  contents: read
  packages: write

jobs:
  upload-docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Package docs
        run: |
          mkdir -p dist/docs
          tar czf dist/docs/alnp-docs-${TAG}.tar.gz README.md SPEC.md docs
        env:
          TAG: ${{ github.event.release.tag_name }}
      - name: Upload docs asset
        uses: actions/upload-release-asset@v1
        with:
          upload_url: ${{ github.event.release.upload_url }}
          asset_path: dist/docs/alnp-docs-${{ github.event.release.tag_name }}.tar.gz
          asset_name: alnp-docs-${{ github.event.release.tag_name }}.tar.gz
          asset_content_type: application/gzip
